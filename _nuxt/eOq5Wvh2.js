import{an as W,h as v,ao as Y,ap as J,aq as K,ar as G,Y as X,as as Z,c as C,o as A,F as E,r as ee,x as te,E as re,G as se,f as $,at as ne,au as ae,A as oe,av as ie,aw as I,K as x,ax as ce,al as N,g as le,ay as ue,az as M,am as F,aA as D,s as V,w as T,i as de,b as q,j as S,q as L,d as H,m as fe,a as j,n as pe,p as me}from"./CTM-UXwp.js";import{_ as ge}from"./05kT4I3W.js";import{d as he}from"./CgvfCpju.js";const ye=["type","sizes","srcset"],be=["src","sizes","srcset"],ve=Object.assign({inheritAttrs:!1},{__name:"NuxtPicture",props:{legacyFormat:{type:String,required:!1},imgAttrs:{type:Object,required:!1},src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[String,Number],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:null,required:!1},sizes:{type:[String,Object],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},crossorigin:{type:[String,Boolean],required:!1},nonce:{type:String,required:!1}},emits:["load","error"],setup(s,{emit:e}){const t=s,r=e,a=W(),o=new Set(["alt","referrerpolicy","usemap","longdesc","ismap","loading","crossorigin","decoding","nonce"]),i=v(()=>{const m={img:{...y.value,...t.imgAttrs,"data-nuxt-pic":""},picture:{}};for(const h in a)o.has(h)?h in m.img||(m.img[h]=a[h]):m.picture[h]=a[h];return m}),n=v(()=>t.src?.match(/^[^?#]+\.(\w+)(?:$|[?#])/)?.[1]),c=v(()=>t.legacyFormat?t.legacyFormat:!n.value||!["png","webp","gif","svg"].includes(n.value)?"jpeg":"png"),l=J(),{providerOptions:u,imageModifiers:f,normalizedAttrs:y}=Y(t),k=v(()=>{const m=t.format?.split(",")||(n.value==="svg"?["svg"]:l.options.format?.length?[...l.options.format]:["webp"]);return m[0]==="svg"?[{src:t.src}]:(m.includes(c.value)&&m.splice(m.indexOf(c.value),1),m.push(c.value),m.map(h=>{const{srcset:_,sizes:w,src:Q}=l.getSizes(t.src,{...u.value,sizes:t.sizes||l.options.screens,densities:t.densities,modifiers:{...f.value,format:h}});return{src:Q,type:`image/${h}`,sizes:w,srcset:_}}))}),d=K().isHydrating,b=G("imgEl");return X(()=>{const m=Array.isArray(b.value)?b.value[0]:b.value;m&&(m.complete&&d&&(m.getAttribute("data-error")?r("error",new Event("error")):r("load",new Event("load"))),m.onload=h=>{r("load",h)},m.onerror=h=>{r("error",h)},Z("nuxt-picture"))}),(m,h)=>(A(),C("picture",re(se(i.value.picture)),[(A(!0),C(E,null,ee(k.value,(_,w)=>(A(),C(E,null,[w+1<k.value.length?(A(),C("source",{key:_.src,type:_.type,sizes:_.sizes,srcset:_.srcset},null,8,ye)):(A(),C("img",te({ref_for:!0,ref_key:"imgEl",ref:b,key:"last"+_.src},{ref_for:!0},i.value.img,{src:_.src,sizes:_.sizes,srcset:_.srcset}),null,16,be))],64))),256))],16))}}),_e=Object.assign(ve,{__name:"NuxtPicture"}),Se=["href"],Ae={name:"DisclaimerLink"},ke=$({...Ae,props:{url:{}},setup(s){const e=s,t=ne();if(!t)throw ae({statusCode:500,statusMessage:"DisclaimerLink must be used inside DisclaimerProvider",fatal:!0});const{shouldShowDisclaimer:r}=t,{showDisclaimer:a}=t;async function o(i){r.value&&(i.preventDefault(),await a(e.url)&&ie(e.url,{external:!0,open:{target:"_blank",windowFeatures:{noopener:!0,noreferrer:!0}}}))}return(i,n)=>(A(),C("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",class:"group",onClick:o},[oe(i.$slots,"default")],8,Se))}}),We=Object.assign(ke,{__name:"CoreDisclaimerLink"}),U=I("debouncedInput",()=>{const s=x(""),e=x(""),t=x(null),r=x(!1);function a(i,n=300){s.value=i,t.value&&clearTimeout(t.value),r.value=!0,t.value=setTimeout(()=>{e.value=i,r.value=!1,t.value=null},n)}function o(){s.value="",e.value="",t.value&&(clearTimeout(t.value),t.value=null),r.value=!1}return{input:s,debouncedInput:e,debounceTimer:t,isDebouncing:r,setInput:a,clearInput:o}}),g={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0},z={maxRanking:1/0,minRanking:-1/0};function O(s,e,t){if(t=t||{},t.threshold=t.threshold??g.MATCHES,!t.accessors){const a=P(s,e,t);return{rankedValue:s,rank:a,accessorIndex:-1,accessorThreshold:t.threshold,passed:a>=t.threshold}}const r=qe(s,t.accessors);for(let a=0;a<r.length;a++){const o=r[a];let i=P(o.itemValue,e,t);const{minRanking:n,maxRanking:c,threshold:l=t.threshold}=o.attributes;if(i<n&&i>=g.MATCHES?i=n:i>c&&(i=c),i=Math.min(i,c),i>=l&&i>g.NO_MATCH)return{rank:i,passed:!0,accessorIndex:a,accessorThreshold:l,rankedValue:o.itemValue}}return{rankedValue:s,rank:g.NO_MATCH,accessorIndex:-1,accessorThreshold:t.threshold,passed:!1}}function P(s,e,t){if(s=R(s,t),e=R(e,t),e.length>s.length)return g.NO_MATCH;if(s===e)return g.CASE_SENSITIVE_EQUAL;if(s=s.toLowerCase(),e=e.toLowerCase(),s===e)return g.EQUAL;if(s.startsWith(e))return g.STARTS_WITH;if(s.includes(e)){const r=s.indexOf(e);return g.CONTAINS+1/(r+1)}else if(e.length===1)return g.NO_MATCH;return Ce(s).includes(e)?g.ACRONYM:Ie(s,e)}function Ce(s){let e="";return s.split(" ").forEach(r=>{r.split("-").forEach(o=>{e+=o.substr(0,1)})}),e}function Ie(s,e){let t=0,r=0;function a(c,l,u){for(let f=u,y=l.length;f<y;f++)if(l[f]===c)return t+=1,f+1;return-1}function o(c){const l=1/c,u=t/e.length;return g.MATCHES+u*l}const i=a(e[0],s,0);if(i<0)return g.NO_MATCH;r=i;for(let c=1,l=e.length;c<l;c++){const u=e[c];if(r=a(u,s,r),!(r>-1))return g.NO_MATCH}const n=r-i;return o(n)}function R(s,{keepDiacritics:e}){return s=`${s}`,s}function xe(s,e){let t=e;typeof e=="object"&&(t=e.accessor);const r=t(s);return r==null?[]:Array.isArray(r)?r:[String(r)]}function qe(s,e){const t=[];for(let r=0,a=e.length;r<a;r++){const o=e[r],i=Te(o),n=xe(s,o);for(let c=0,l=n.length;c<l;c++)t.push({itemValue:n[c],attributes:i})}return t}function Te(s){return typeof s=="function"?z:{...z,...s}}function Ne(s,e,t){return Object.keys(e).map(r=>O(r,t,{threshold:g.ACRONYM})).filter(r=>r.passed).map(r=>({label:r.rankedValue,query:{fieldFilters:[{key:s,value:[r.rankedValue]}]},rank:r.rank,meta:{field:s,matchingText:t,count:e[r.rankedValue]}}))}function we(s,e){const t=N("~/composables/useSuggestions/rankSuggestions");if(e==="")return t.debug("No search term provided, returning no suggestions."),[];const a=s.data.map(n=>{const c=O(n,e,{threshold:g.ACRONYM,accessors:[f=>f.name]}),l=O(n,e,{threshold:g.CONTAINS,accessors:[{accessor:f=>f.description,maxRanking:3}]}),u=[c,l].toSorted((f,y)=>y.rank-f.rank)[0];return{...u,item:n,field:u===c?"name":u===l?"description":void 0}}).filter(n=>n.passed).map(n=>{const c=n.item?.name??n.rankedValue.name;return{label:c,query:{searchTerm:c,selected:!0,fieldFilters:[]},rank:n.rank,meta:{field:n.field==="name"?"name":n.field==="description"?"description":void 0,matchingText:e,count:0}}}),o=Object.entries(s.fields).filter(([n])=>n==="tags").flatMap(([n,c])=>Ne(n,c,e));return[...a,...o].toSorted((n,c)=>c.rank-n.rank)}const He=ce(()=>{const s=N("~/composables/useSuggestions"),{data:e,error:t,status:r}=le(he),a=U(),{debouncedInput:o}=ue(a),i=v(()=>e.value===void 0?(s.debug("No data available, returning no suggestions."),[]):(s.debug("Computing suggestions for input:",o.value),we(e.value,o.value)));return{status:r,error:t,suggestions:i}});function Oe(s){const{storeId:e}=s,t=I(`${e}:private`,()=>({fieldFilterState:F({filters:[]})}),{persist:[{storage:M.sessionStorage()}]});return I(e,()=>{const r=N(`stores/${e}`),a=t(),o=v(()=>a.fieldFilterState.filters);function i(){r.debug("Resetting current filters"),a.fieldFilterState={filters:[]}}function n(l){r.debug("Setting filters: ",l),a.fieldFilterState={...l}}const c=v(()=>Object.values(o.value).flatMap(u=>u.value).length>0);return{fieldFilters:o,reset:i,set:n,hasFilters:c}})}const $e=Oe({storeId:"filters"});function Me(s){const{storeId:e,maxHistory:t=5}=s,r=I(`${e}:private`,()=>({history:F([])}),{persist:{storage:M.sessionStorage()}});return I(`${e}`,()=>{const a=N(`stores/${e}`),o=r(),i=v(()=>o.history),n=v(()=>o.history.length>0);function c(u){const f=o.history.findIndex(y=>y.label===u.label);if(f===-1)o.history.length>=t&&(a.debug(`History exceeded max length of ${t}. Removing oldest entry.`),o.history=o.history.slice(0,t-1)),a.debug(`Adding new suggestion to history: "${u.label}"`),o.history=[u,...o.history];else{a.debug(`Suggestion already in history. Moving to top: "${u.label}"`);const y=o.history[f];if(y){const k=[...o.history];o.history=[y,...k.slice(0,f),...k.slice(f+1)]}}}function l(){a.debug("Clearing search history"),o.history=[]}return{getHistory:i,hasHistory:n,addToHistory:c,clearHistory:l}})}const Fe=Me({storeId:"history"});function Ee(s){const{storeId:e}=s,t=I(`${e}:private`,()=>({queryState:F({searchTerm:void 0,selected:void 0})}),{persist:[{storage:M.sessionStorage()}]});return I(e,()=>{const r=N(`stores/${e}`),a=t(),o=v(()=>a.queryState.searchTerm!==void 0),i=v(()=>a.queryState);function n(){r.debug("Clearing current query, including search term and filters"),a.queryState={searchTerm:void 0,selected:void 0}}function c(u){r.debug("Setting search query: ",u),a.queryState={searchTerm:u.searchTerm,selected:u.selected}}function l(u){r.debug("Replacing current query with new query: ",u),a.queryState={searchTerm:u.searchTerm,selected:u.selected}}return{searchQuery:i,hasQuery:o,clear:n,replaceQueryAndFilters:l,setSearch:c}})}const B=Ee({storeId:"query"}),Ve={name:"AutocompleteMenu"},je=$({...Ve,setup(s){const e=D(),t=Fe(),r=B(),a=$e(),{suggestions:o,status:i}=He(),n=U();function c(p){p!==void 0&&(r.setSearch(p.query),t.addToHistory(p),a.set({filters:p.query.fieldFilters.map(d=>({key:d.key,value:d.value}))??[]}),e.push({path:"/search"}))}function l(p){if(p!==""){const d={label:p,rank:0,query:{searchTerm:p,fieldFilters:[]}};r.setSearch(d.query),t.addToHistory(d),a.reset(),e.push({path:"/search"})}else r.clear(),e.push({path:"/search"})}function u(p){const d=p.meta?.field;if(d==="description")return`"${p.meta?.matchingText??p.label}" found in description`;if(d==="tags")return`${p.meta?.count??"Discover"} dataset(s) with this tag`}function f(p){const d=p.meta?.field;return d==="name"||d==="description"?"lucide:database":d==="tags"?"lucide:tag":(console.log("unknown suggestion",p),"lucide:search")}const y=v(()=>{if(n.input==="")if(t.getHistory.length>0){const p=t.getHistory.map(d=>({label:d.label,icon:f(d),onSelect:()=>c(d)}));return[{label:"Recent Searches",type:"label"},...p]}else return[];else{const p={label:`Search for "${n.input}"`,leadingIcon:"lucide:search",onSelect:()=>l(n.input)},d=o.value.map(b=>({label:`${b.label}`,description:u(b),icon:f(b),type:"item",onSelect:()=>c(b)}));return[p,...d]}}),k=x("");return(p,d)=>{const b=L,m=ge;return A(),V(m,{"search-term":S(n).input,"model-value":S(k),items:S(y),"ignore-filter":"",icon:"lucide:search","loading-icon":"lucide:loader",loading:S(i)==="pending",placeholder:"Search datasets","open-on-click":"",ui:{root:"w-full mt-4",base:"h-12"},"onUpdate:searchTerm":S(n).setInput},{empty:T(()=>[...d[1]||(d[1]=[H(" Start typing to find suggestions ",-1)])]),trailing:T(()=>[S(n).input!==""?(A(),V(b,{key:0,color:"neutral",variant:"ghost",ui:{base:"bg-default mr-0.5"},size:"xs",icon:"lucide:circle-x","aria-label":"Clear input field",onClick:S(n).clearInput},null,8,["onClick"])):de("",!0),q(b,{to:"/search",onClick:d[0]||(d[0]=h=>l(S(n).input))},{default:T(()=>[...d[2]||(d[2]=[H(" Search ",-1)])]),_:1})]),_:1},8,["search-term","model-value","items","loading","onUpdate:searchTerm"])}}}),ze=Object.assign(je,{__name:"AutocompleteMenu"}),Pe={class:"bg-linear-to-r from-blue-50 via-blue-100 to-blue-50"},Re={class:"flex justify-start w-full"},De={name:"SearchHero"},Le=$({...De,setup(s){const e=fe();return(t,r)=>{const a=_e,o=L,i=me;return A(),C("section",Pe,[q(i,{class:"h-96 flex flex-col items-center justify-center max-w-200 text-center"},{default:T(()=>[q(a,{src:"/images/datahub.png",alt:"DataHub Logo","img-attrs":{class:"h-[56px] mb-4"}}),r[1]||(r[1]=j("p",{class:"text-lg"}," The U.S. Department of Transportation Intelligent Transportation Systems (ITS) Joint Program Office's (JPO) portal for open-access data. ",-1)),q(ze),j("div",Re,[q(o,{to:"/search",variant:"link",size:"sm",class:pe({invisible:S(e).fullPath!=="/"})},{default:T(()=>[...r[0]||(r[0]=[H(" View all ",-1)])]),_:1},8,["class"])])]),_:1})])}}}),Ye=Object.assign(Le,{__name:"SearchHero"});function Je(){const s=B(),e=D();async function t(r){s.setSearch({searchTerm:r,selected:void 0}),await e.push({path:"/search"})}return{searchByTopic:t}}const Ke={"Connected Vehicle Message":{icon:"/images/topics/cv-message.webp"},"Application Message":{icon:"/images/topics/application-message.webp"},Trajectories:{icon:"/images/topics/trajectories.webp"},"Field Test":{icon:"/images/topics/field-test.webp"},"Sensor Data":{icon:"/images/topics/sensor-data.webp"},"Research Results":{icon:"/images/topics/research-results.webp"},"Connected Equipment":{icon:"/images/topics/connected-equipment.webp"},Weather:{icon:"/images/topics/weather.webp"}};export{Ye as S,_e as _,We as a,$e as b,g as c,B as d,O as r,Ke as t,Je as u};
