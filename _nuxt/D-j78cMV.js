import{f as d,al as u,ar as f,Y as h,s as m,o as w,w as C,a as c,$ as _,c4 as b}from"./CTM-UXwp.js";import{u as y}from"./DEcuSdUg.js";import{g}from"./CxFUOmY2.js";import"./_e_qfkaz.js";const v={class:"flex flex-col items-center"},W={name:"CaptchaModal"},k=d({...W,props:{url:{},apiKey:{},isDev:{type:Boolean},body:{}},emits:["close"],setup(n,{emit:r}){const t=n,s=r,e=u("captcha-modal");y();const o=f("captchaRef");async function i(){if(!window||!window.AwsWafCaptcha){e.warn("Window object or AwsWafCaptcha not available. Cannot render captcha.");return}if(await _(),!o.value){e.warn("Captcha ref not available. Cannot render captcha.");return}e.info("Has ref object attached, rendering captcha..."),window.AwsWafCaptcha.renderCaptcha(o.value,{apiKey:t.apiKey,dynamicWidth:!0,disableLanguageSelector:!0,skipTitle:!0,onSuccess:l})}async function l(){if(!window||!window.AwsWafIntegration){e.warn("Window object not available. Cannot submit captcha.");return}try{const a=await window.AwsWafIntegration.fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",...t.isDev?{"x-dev-mode":"true"}:{}},body:t.body});a?.ok?(e.info("Captcha submission successful."),s("close",{status:"success"})):s("close",{status:"error",error:`Captcha submission failed with status ${a?.status}: ${a?.statusText}`})}catch(a){s("close",{status:"error",error:`Submission failed with error: ${g(a)}`})}}return h(()=>{i()}),(a,x)=>{const p=b;return w(),m(p,{title:"Complete the Captcha",description:"Complete the captcha and click 'Confirm' to submit",close:{onClick:()=>{s("close",{status:"dismiss"})}}},{body:C(()=>[c("div",v,[c("div",{id:"captcha-container",ref_key:"captchaRef",ref:o,class:"w-75"},null,512)])]),_:1},8,["close"])}}}),$=Object.assign(k,{__name:"CoreCaptchaModal"});export{$ as default};
